{% extends "_layout.html" %}
{% block title %}Import Sales Orders PDF{% endblock %}
{% block content %}
<div class="card">
    <h1 style="margin-top:0;">Bulk PDF Import</h1>
    <p class="muted">Upload bulk Sales Order or Shipping Label PDFs to match with existing distributions.</p>
    
    <div style="display:flex; gap:10px; margin-bottom:16px;">
        <a class="button button--secondary" href="{{ url_for('rep_traceability.sales_orders_list') }}">&larr; Back to List</a>
    </div>
</div>

<div style="height: 14px;"></div>

<div class="card">
    {% if pdfplumber_available %}
    <h2 style="margin-top:0;">Upload PDFs</h2>
    <form class="form" method="post" action="{{ url_for('rep_traceability.sales_orders_import_pdf_bulk') }}" enctype="multipart/form-data" id="bulk-pdf-form">
        <div>
            <div class="label">Select PDF Files</div>
            <input type="file" name="pdf_files" accept=".pdf,application/pdf" multiple required />
            <p class="muted" style="margin-top:4px; font-size:12px;">
                Select one or more PDFs. Max 10MB per file, 50MB total.
            </p>
        </div>
        <button class="button" type="submit" id="bulk-submit-btn">Import PDFs</button>
    </form>
    {% else %}
    <div class="alert alert--danger">
        <strong>Error:</strong> PDF parsing library (pdfplumber) is not installed.
    </div>
    {% endif %}
</div>

<div style="height: 14px;"></div>

<div class="card">
    <h3 style="margin-top:0;">How It Works</h3>
    <ol style="margin:8px 0; padding-left:20px;">
        <li><strong>Upload</strong> - Select your bulk Sales Order or Shipping Label PDFs</li>
        <li><strong>Parse</strong> - Each page is parsed to extract Order Numbers or Tracking Numbers</li>
        <li><strong>Match</strong> - Pages are matched to existing distributions</li>
        <li><strong>Link</strong> - Matched PDFs are attached for download</li>
    </ol>
</div>

<div style="height: 14px;"></div>

<div class="card" style="background: #fef3c7; border-left: 3px solid #d97706;">
    <h3 style="margin-top:0;">Important</h3>
    <ul style="margin:8px 0; padding-left:20px;">
        <li>This import does NOT create new distributions or customers</li>
        <li>PDFs are matched to existing distributions only</li>
    </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var bulkForm = document.getElementById('bulk-pdf-form');
    if (bulkForm) {
        bulkForm.addEventListener('submit', function(e) {
            var submitBtn = document.getElementById('bulk-submit-btn');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Uploading...';
            }
        });
    }
});
</script>
{% endblock %}